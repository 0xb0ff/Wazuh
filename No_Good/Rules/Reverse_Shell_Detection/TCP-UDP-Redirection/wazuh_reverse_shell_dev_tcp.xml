  <rule id="100101" level="15">
    <decoded_as>linux_command</decoded_as>
    <location>/var/log/cmdline</location> <!-- Comment for testing with wazuh-logtest -->
    <field name="command" type="pcre2">(?i)\b(?:bash|sh|dash|zsh|ksh|mksh|ash|csh|tcsh|fish)\b</field>
    <match type="pcre2">(?i)/dev/(?:tcp|udp)/\d{1,3}(?:\.\d{1,3}){3}</match>
    <description>Possible Reverse Shell Command Detected (/dev/tcp)</description>
    <mitre>
      <id>T1059.004</id>
      <id>T1219</id>
      <id>T1105</id>
    </mitre>
    <group>command_execution,reverse_shell,attack</group>
  </rule>
