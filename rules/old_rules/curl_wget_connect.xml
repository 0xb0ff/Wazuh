<group name="auditd,download_and_exec,">

  <!-- Base: curl executed -->
  <rule id="110400" level="5">
    <if_group>audit</if_group>
    <match>curl-exec</match>
    <description>curl command executed</description>
    <group>network,</group>
  </rule>

  <!-- Base: wget executed -->
  <rule id="110402" level="5">
    <if_group>audit</if_group>
    <match>wget-exec</match>
    <description>wget command executed</description>
    <group>network,</group>
  </rule>

  <!-- Escalation: curl OR wget piped to a shell -->
  <rule id="110403" level="15">
    <if_sid>110400,110402</if_sid>
    <regex>\|\s*(/bin/)?sh|\|\s*(/bin/)?bash</regex>
    <description>High-risk behavior: downloaded content piped directly into a shell (curl/wget | sh/bash)</description>
    <group>attack,execution,reverse_shell,</group>
  </rule>

</group>
