<group name="auditd,reverse_shell,netcat,">

  <!-- Baseline: netcat family performed connect() (visibility) -->
  <rule id="110310" level="3">
    <if_sid>80700</if_sid>
    <field name="audit.key">netcat-connect</field>
    <description>Netcat-like initiated network connect() (baseline)</description>
    <group>network,</group>
  </rule>

  <!-- Critical: netcat with -e sh/-c sh (ASCII OR hex proctitle) -->
  <rule id="110311" level="15">
    <if_sid>110310</if_sid>
    <regex>7368</regex> <!-- -e sh and -c sh-->
    <description>Reverse shell indicator: netcat-like used -e/-c to spawn sh</description>
    <group>attack,reverse_shell,</group>
  </rule>

  <!-- High: FIFO pipeline patterns often used with nc (ASCII OR hex) -->
  <rule id="110312" level="14">
    <if_sid>110310</if_sid>
    <regex>2d65|2d63</regex> <!-- -c sh -->
    <description>Reverse shell indicator: FIFO/pipeline to sh used with netcat-like connection</description>
    <group>attack,reverse_shell,</group>
  </rule>

  <!-- Critical on web context -->
  <rule id="110313" level="15">
    <if_sid>110310</if_sid>
    <field name="uid">^33$</field>
    <description>Critical: web user executed netcat-like outbound connection</description>
    <group>attack,reverse_shell,web,critical,</group>
  </rule>

</group>
