  <rule id="100102" level="15">
    <decoded_as>linux_command</decoded_as>
    <location>/var/log/cmdline</location> <!-- Comment for testing with wazuh-logtest -->
    <field name="command" type="pcre2">(?i)\b(?:nc|ncat|netcat)\b.*?(?:\s-(?:e|c)\s+(?:/bin/)?(?:bash|sh|dash|zsh|ksh|mksh|ash|csh|tcsh|fish|exec)\b|/dev/(?:tcp|udp)/)</field>
    <description>Possible Reverse Shell Command Detected (netcat)</description>
    <mitre>
      <id>T1059.004</id>
      <id>T1219</id>
      <id>T1105</id>
    </mitre>
    <group>command_execution,reverse_shell,attack</group>
  </rule>
